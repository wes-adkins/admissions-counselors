<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Campus Counselor Finder (Prototype)</title>

  <!-- Bootstrap 5 -->
<link href="https://www.indwes.edu/shared-resources/_files/css/bootstrap-reskin.min.css" rel="stylesheet" type="text/css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script crossorigin="anonymous" src="https://kit.fontawesome.com/3acd8de7af.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i" rel="stylesheet" type="text/css"/>
<link href="https://cdn.fonts.net" rel="preconnect"/>
<link href="https://cdn.fonts.net/kit/515a1de4-1b14-4f0e-af45-f6b16a50338c/515a1de4-1b14-4f0e-af45-f6b16a50338c.css" rel="stylesheet"/>

  <style>
    :root {
      --iwu-navy: #0b1f3b;
    }
    body { background: #f7f8fa; }
    .brand-bar { background: var(--iwu-navy); color: #fff; }
    .step-card { border: 0; border-radius: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,.06); }
    .option-btn { border-radius: .9rem; }
    .progress-pill { font-size: .85rem; }

    /* =============================
       MAP LAYOUT (CLEAN + SAFE)
       ============================= */

    /* Wrapper reserves vertical space so SVG never overlaps content above */
    .map-ratio {
      position: relative;
      width: 100%;
      /* Aspect ratio tuned for US map */
      padding-top: 55%;
    }

    /* Map container fills the ratio box */
    #map-wrap {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    /* SVG scales to fit without overflowing */
    #map-wrap svg {
      width: 100% !important;
      height: 100% !important;
      display: block;
    }

    /* State interaction styling */
    #map-wrap svg [id],
    #map-wrap svg path,
    #map-wrap svg polygon,
    #map-wrap svg g {
      cursor: pointer;
      transition: fill 120ms ease, opacity 120ms ease;
    }

    #map-wrap svg .state-shape {
      fill: #a6192e !important;
      outline: none !important;
    }

    #map-wrap svg .state-shape:hover {
      fill: #701d29 !important;
    }

    #map-wrap svg .state-shape:focus,
    #map-wrap svg .state-shape:focus-visible {
      outline: none !important;
      box-shadow: none !important;
    }

    .max100 { max-width: 100%; border-radius: 5px; }

    .counselor_details {
      background: #f4f4f4;
      border-bottom-right-radius: 6px;
      border-bottom-left-radius: 6px;
      padding: 30px;
      border-top: 8px solid #982832;
    }

    .counselor_details strong { font-size: 1.5rem; }

    @media (max-width: 600px) {
      .max100 { margin-bottom: 30px; max-width: 65%; }
    }

    .muted-note { color: #5b6676; }

    /* Simple max-height collapse animation (keeps content in DOM for indexing) */
    .collapse-animate {
      overflow: hidden;
      transition: max-height .35s ease, opacity .25s ease;
    }
    .collapse-hidden {
      max-height: 0;
      opacity: 0;
    }
    .collapse-visible {
      max-height: 1000px;
      opacity: 1;
    }

    /* Map sizing: keep the full U.S. visible and contained in the card */
    .map-card { overflow: visible; }

    /* The frame controls the map height so it never overlaps other content */
    .map-frame {
      width: 100%;
      height: clamp(240px, 42vw, 560px);
      position: relative;
      overflow: hidden;
    }

    #map-wrap {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    #map-wrap svg {
      width: 100% !important;
      height: 100% !important;
      display: block;
      max-width: 100% !important;
      max-height: 100% !important;
    }

    .counselor_details i { margin-right: 5px; }
  </style>
</head>

<body>

 <header class="brand-bar">
    <div class="container">
      <div class="d-flex align-items-center justify-content-between gap-3">
        <button id="btnRestart" class="btn btn-outline-light btn-sm" type="button">Restart</button>
      </div>
    </div>
  </header>

  

  <main class="container my-4 my-lg-5">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-9 col-xl-8">

        <!-- Progress -->
        <div class="d-flex align-items-center justify-content-between mb-3">
          <span id="progressLabel" class="badge text-bg-secondary progress-pill">Step 1 of 2</span>
          <button id="btnBack" class="btn btn-link text-decoration-none px-0" type="button" style="visibility:hidden;">← Start Over</button>
        </div>

        <div class="card step-card">
          <div class="card-body p-4 p-lg-5">

            <!-- STEP 1 -->
            <section id="step1" class="step">
              <h1 class="h3">Who are you?</h1>
              <p class="muted-note mb-4">Choose the option that best fits your situation.</p>

            

              <div class="d-grid gap-3">
                <button class="btn border option-btn text-start p-3" type="button" data-step1="first-time">
                  <div class="fw-semibold">First-time IWU Student</div>
                  <div class="small text-muted">I am applying for the first time</div>
                </button>

                <button class="btn border option-btn text-start p-3" type="button" data-step1="current-past">
                  <div class="fw-semibold">Current or Past IWU Student</div>
                  <div class="small text-muted">I have attended or I am currently enrolled</div>
                </button>
              </div>
            </section>

            <!-- STEP 2A: First-time -->
            <section id="step2A" class="step" hidden>
              <h2 class="h3">What type of student are you?</h2>
              <p class="muted-note mb-4">Select how you plan to attend Indiana Wesleyan University.</p>

              <div class="row g-2 align-items-end mb-3">
                <div class="col">
                  <label for="firstTimeType" class="form-label fw-semibold">Student type</label>
                  <select id="firstTimeType" class="form-select">
                    <option value="" selected disabled>Select one</option>
                    <option value="freshman">First-time Freshman</option>
                    <option value="transfer">Transfer Students</option>
                    <option value="international">International Students</option>
                    <option value="graduate">Graduate Students (Residential Masters and Doctorate Degrees)</option>
                    <option value="tck-mk">Third Culture Kids (TCK) and Missionary Kids (MK)</option>
                    <option value="dual">Dual Citizenship, DACA, and TPS Students</option>
                  </select>
                </div>
                <div class="col-auto">
                  <button id="clearFirstTime" type="button" class="btn btn-outline-primary" hidden>Clear</button>
                </div>
              </div>

              <!-- Pre-rendered First-time Counselor Sections (SEO-safe) -->
              <div id="resultFirstTime" class="mt-4">

                <!-- Freshman Map -->
                <section data-ft="freshman" class="collapse-animate collapse-hidden" hidden>

                  <!-- MAP VIEW -->
                  <div id="freshmanMapView">
                    <div class="card shadow-sm map-card" style="border-radius:1rem;">
                      <div class="card-header d-flex align-items-center justify-content-between" style="border-top-left-radius:1rem;border-top-right-radius:1rem;">
                        <div>
                          <div class="fw-semibold">Where are you from?</div>
                          <div class="text-body-secondary small">Click a state to find your Admissions Counselor</div>
                        </div>
                        <button id="btn-reset" type="button" class="btn btn-outline-primary btn-sm">Reset Map</button>
                      </div>
                      <div class="card-body">
                        <div id="map-status" class="alert alert-info py-2 small mb-3">Loading map…</div>
                        <div class="bg-white border rounded p-2 overflow-hidden" style="width:100%;">
                          <div class="map-frame">
                            <div id="map-wrap" aria-label="Clickable map of the United States"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- RESULT VIEW -->
                  <div id="freshmanResultView" hidden>
                    <a href="#" id="backToMap" class="small text-decoration-none d-inline-block mb-2">← Back to map</a>

                    <div id="freshmanIndianaControls" class="mb-3" hidden>
                      <label for="freshmanCountySelect" class="form-label fw-semibold">Select your Indiana county</label>
                      <select id="freshmanCountySelect" class="form-select">
                        <option value="" selected>Select a county…</option>
                      </select>
                    </div>

                    <div id="freshmanResultHost"></div>
                  </div>

                </section>

                <!-- Transfer -->
                <section data-ft="transfer" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Transfer Students</div>
                      <p class="text-muted mb-3">Are you considering a move to Indiana Wesleyan from another college or university? We'd love to chat. Reach out today!</p>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Brittany-Moser-headshot.jpg" alt="Brittany Moser headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Brittany Moser</div>
                          <div class="small">Email: <a href="mailto:brittany.moser@indwes.edu">brittany.moser@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772365">765-677-2365</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://outlook.office.com/bookwithme/user/9c75f0e3006b479d87343b7b33463151%40indwes.edu/meetingtype/65de897c-4845-40e6-b75d-e69b207539c4?anonymous=" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

                <!-- International -->
                <section data-ft="international" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">International Students</div>
                      <p class="text-muted mb-3">Are you an international student interested in studying at Indiana Wesleyan? We're here to answer your questions and help get you started!</p>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Tony-Stevens-headshot.jpg" alt="Tony Stevens headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Tony Stevens</div>
                          <div class="small">Email: <a href="mailto:tony.stevens@indwes.edu">tony.stevens@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772921">765-677-2921</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://calendly.com/tony-stevens-6im_/30min" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

                <!-- Graduate -->
                <section data-ft="graduate" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Graduate Students (Residential Masters and Doctorate Degrees)</div>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/laura-marine.webp" alt="Laura Marine headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Laura Marine</div>
                          <div class="small">Email: <a href="mailto:laura.marine@indwes.edu">laura.marine@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772572">765-677-2572</a></div>
                        </div>
                      </div>
                      <p class="small text-muted mt-2 mb-0">Serving students with interest in the Doctor of Physical Therapy program and the Doctor of Occupational Therapy program.</p>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="mailto:laura.marine@indwes.edu" role="button">Email Laura</a>
                      </div>
                    </div>
                  </div>
                </section>

                <!-- TCK and MK -->
                <section data-ft="tck-mk" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Third Culture Kids (TCK) and Missionary Kids (MK)</div>
                      <p class="text-muted mb-3">Are you a Third Culture or Missionary Kid? Our team is here to serve you!</p>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Tony-Stevens-headshot.jpg" alt="Tony Stevens headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Tony Stevens</div>
                          <div class="small">Email: <a href="mailto:tony.stevens@indwes.edu">tony.stevens@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772921">765-677-2921</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://calendly.com/tony-stevens-6im_/30min" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

                <!-- Dual, DACA, TPS -->
                <section data-ft="dual" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Dual Citizenship, DACA, and TPS Students</div>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Tony-Stevens-headshot.jpg" alt="Tony Stevens headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Tony Stevens</div>
                          <div class="small">Email: <a href="mailto:tony.stevens@indwes.edu">tony.stevens@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772921">765-677-2921</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://calendly.com/tony-stevens-6im_/30min" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

              </div>
            </section>

            <!-- STEP 2B: Current/Past -->
            <section id="step2B" class="step" hidden>
              <h2 class="h3">What are you looking to do?</h2>
              <p class="muted-note mb-4">Select the option that best describes your situation.</p>

              <div class="row g-2 align-items-end mb-3">
                <div class="col">
                  <label for="currentPastType" class="form-label fw-semibold">Select an option</label>
                  <select id="currentPastType" class="form-select">
                    <option value="" selected disabled>Select one</option>
                    <option value="readmit">Seeking Readmission to IWU-Marion</option>
                    <option value="online-to-campus">Transition from Online to On-Campus</option>
                  </select>
                </div>
                <div class="col-auto">
                  <button id="clearCurrentPast" type="button" class="btn btn-outline-secondary" hidden>Clear</button>
                </div>
              </div>

              <div id="resultCurrentPast" class="mt-4">

                <section data-cp="readmit" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Seeking Readmission to IWU-Marion</div>
                      <p class="text-muted mb-3">Are you prior IWU student and ready to come back? Tony is here to help!</p>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Tony-Stevens-headshot.jpg" alt="Tony Stevens headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Tony Stevens</div>
                          <div class="small">Email: <a href="mailto:tony.stevens@indwes.edu">tony.stevens@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772921">765-677-2921</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://calendly.com/tony-stevens-6im_/30min" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

                <section data-cp="online-to-campus" class="collapse-animate collapse-hidden" hidden>
                  <div class="card border-0 bg-light" style="border-radius:1rem;">
                    <div class="card-body p-4">
                      <div class="h5">Transition from Online to On-Campus</div>
                      <p class="text-muted mb-3">Are you a current IWU N and G (online) student and interested in attending the Marion campus? The transition to our beautiful Marion campus is quick and easy!</p>
                      <div class="d-flex align-items-start gap-3">
                        <img src="https://www.indwes.edu/admissions/campus/_img/Tony-Stevens-headshot.jpg" alt="Tony Stevens headshot" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />
                        <div>
                          <div class="fw-semibold">Tony Stevens</div>
                          <div class="small">Email: <a href="mailto:tony.stevens@indwes.edu">tony.stevens@indwes.edu</a></div>
                          <div class="small">Phone: <a href="tel:+17656772921">765-677-2921</a></div>
                        </div>
                      </div>
                      <div class="d-flex flex-wrap gap-2 mt-3">
                        <a class="btn btn-primary" href="https://calendly.com/tony-stevens-6im_/30min" role="button">Schedule a Chat</a>
                      </div>
                    </div>
                  </div>
                </section>

              </div>
            </section>

          </div>
        </div>



      </div>
    </div>
  </main>

  <!-- Counselor data used by the map (keep this in the DOM, but hidden) -->
  <div class="d-none" aria-hidden="true">
    <div class="counselor_details" id="counselor1">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Chase Huffman" class="max100" src="https://www.indwes.edu/admissions/campus/_img/chase-huffman.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Chase Huffman is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:chase.huffman@indwes.edu" title="Send Email">chase.huffman@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/chase-huffman-indwes" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-1648</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3246</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/chase-huffman" title="Get to Know">Get to Know Chase</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor3">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Bedford Fleuriot headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/bedford-fleuriot.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Bedford Fleuriot is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:bedford.fleuriot@indwes.edu" title="Send Email">bedford.fleuriot@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/bedford-fleuriot" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-1308</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3242</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/bedford-fleuriot" title="Get to Know">Get to Know Bedford</a></p>
          <p class="mt-3"><em>Serving Southern Indiana counties</em></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor4">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Marc Watkins" class="max100" src="https://www.indwes.edu/academics/faculty/_img/headshot-placeholder-red.png" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Marc Watkins is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:marc.watkins@indwes.edu" title="Send Email">marc.watkins@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/marc-watkins-indwes/30min" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-1307</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3113</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/marc-watkins" title="Get to Know">Get to Know Marc</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor5">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Brittany Moser headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/Brittany-Moser-headshot.jpg" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Brittany Moser is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:brittany.moser@indwes.edu" title="Send Email">brittany.moser@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://outlook.office.com/bookwithme/user/9c75f0e3006b479d87343b7b33463151%40indwes.edu/meetingtype/65de897c-4845-40e6-b75d-e69b207539c4?anonymous" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2365</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3075</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/brittany-moser" title="Get to Know">Get to Know Brittany</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor6">
      Please email us to find your Admissions Counselor! <a href="mailto:admissions@indwes.edu" title="Send Email">admissions@indwes.edu</a>
    </div>

    <div class="counselor_details" id="counselor7">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Eleri Vice headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/eleri-vice.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Eleri Vice is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:eleri.vice@indwes.edu" title="Send Email">eleri.vice@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/eleri-viceiwu" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2921</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3232</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/eleri-vice" title="Get to Know">Get to Know Eleri</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor8">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Scott Ellman headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/scott-ellman.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Scott Ellman is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:scott.ellman@indwes.edu" title="Send Email">scott.ellman@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/scott-ellman/iwu-follow-up-phone-call-with-scott-ellman" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2033</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3171</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/scott-ellman" title="Get to Know">Get to Know Scott</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor9">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Jim Taylor" class="max100" src="https://www.indwes.edu/academics/faculty/_img/headshot-placeholder-red.png" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Jim Taylor is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:jim.taylor@indwes.edu" title="Send Email">jim.taylor@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/jim-taylor-indwes/30min" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2899</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3048</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/jim-taylor" title="Get to Know">Get to Know Jim</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor10">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Drew Engels headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/drew-engels.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Drew Engels is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:drew.engels@indwes.edu" title="Send Email">drew.engels@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/drew-engels-indwes" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2811</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3170</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/drew-engels" title="Get to Know">Get to Know Drew</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor11">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Michael Aronson headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/michael-aronson.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Michael Aronson is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:michael.aronson@indwes.edu" title="Send Email">michael.aronson@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/michael-aronson-indwes" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-3736</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3060</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/michael-aronson" title="Get to Know">Get to Know Michael</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor12">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Bedford Fleuriot headshot" class="max100" src="https://www.indwes.edu/admissions/campus/_img/bedford-fleuriot.webp" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Bedford Fleuriot is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:bedford.fleuriot@indwes.edu" title="Send Email">bedford.fleuriot@indwes.edu</a></p>
          <p><i class="fa-solid fa-calendar-plus"></i> <a href="https://calendly.com/bedford-fleuriot" rel="noopener" target="_blank" title="Schedule a Chat">Schedule a Quick Chat (phone or virtual)</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-1308</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3242</p>
          <p><i class="fa-solid fa-arrow-up-right-from-square"></i> <a href="https://www.indwes.edu/admissions/campus/admissions-counselors/bedford-fleuriot" title="Get to Know">Get to Know Bedford</a></p>
        </div>
      </div>
    </div>

    <div class="counselor_details" id="counselor13">
      <div class="row">
        <div class="col-lg-3 text-center"><img alt="Cara Davis headshot placeholder" class="max100" src="https://www.indwes.edu/academics/faculty/_img/headshot-placeholder-red.png" title="Counselor Photo" /></div>
        <div class="col-lg-9">
          <p><strong>Cara Davis is your Admissions Counselor!</strong></p>
          <hr />
          <p><i class="fa-solid fa-envelope"></i> <a href="mailto:cara.davis@indwes.edu" title="Send Email">cara.davis@indwes.edu</a></p>
          <p><i class="fa-solid fa-phone"></i> 765-677-2702</p>
          <p><i class="fa-solid fa-comment-sms"></i> 765-613-3041</p>
          <p class="mt-3"><em>Serving states west of Indiana</em></p>
        </div>
      </div>
    </div>
  </div>


  <script>
  // Stepper UI and freshman map
  (function () {
    const step1 = document.getElementById('step1');
    const step2A = document.getElementById('step2A');
    const step2B = document.getElementById('step2B');

    const btnBack = document.getElementById('btnBack');
    const btnRestart = document.getElementById('btnRestart');
    const progressLabel = document.getElementById('progressLabel');

    const firstTimeType = document.getElementById('firstTimeType');
    const currentPastType = document.getElementById('currentPastType');

    const resultFirstTime = document.getElementById('resultFirstTime');
    const resultCurrentPast = document.getElementById('resultCurrentPast');

    const clearFirstTime = document.getElementById('clearFirstTime');
    const clearCurrentPast = document.getElementById('clearCurrentPast');

    const pathHeader = document.getElementById('pathHeader');
    const pathHeaderText = document.getElementById('pathHeaderText');
    const pathStartOver = document.getElementById('pathStartOver');

    let path = null;

    function animateClose(section) {
      section.classList.remove('collapse-visible');
      section.classList.add('collapse-hidden');
      window.setTimeout(() => { section.hidden = true; }, 220);
    }

    function animateOpen(section) {
      section.hidden = false;
      window.requestAnimationFrame(() => {
        section.classList.remove('collapse-hidden');
        section.classList.add('collapse-visible');
      });
    }

    function hideAll(containerEl, selector) {
      containerEl.querySelectorAll(selector).forEach(section => {
        if (!section.hidden) {
          animateClose(section);
        } else {
          section.classList.add('collapse-hidden');
          section.classList.remove('collapse-visible');
          section.hidden = true;
        }
      });
    }

    function showOne(containerEl, selector, valueAttr, value) {
      hideAll(containerEl, selector);
      if (!value) return;
      const active = containerEl.querySelector('[' + valueAttr + '="' + value + '"]');
      if (active) animateOpen(active);
    }

    function setPathHeader(nextPath) {
      if (!nextPath) {
        pathHeader.classList.add('d-none');
        pathHeaderText.textContent = 'You have selected';
        return;
      }

      const label = nextPath === 'first-time' ? 'First-time IWU Student' : 'Current or Past IWU Student';
      pathHeaderText.textContent = 'You have selected ' + label;
      pathHeader.classList.remove('d-none');
    }

    function showStep1() {
      path = null;
      step1.hidden = false;
      step2A.hidden = true;
      step2B.hidden = true;
      btnBack.style.visibility = 'hidden';
      progressLabel.textContent = 'Step 1 of 2';

      setPathHeader(null);

      firstTimeType.value = '';
      currentPastType.value = '';

      clearFirstTime.hidden = true;
      clearCurrentPast.hidden = true;

      hideAll(resultFirstTime, '[data-ft]');
      hideAll(resultCurrentPast, '[data-cp]');
    }

    function showStep2(which) {
      path = which;
      step1.hidden = true;
      step2A.hidden = which !== 'first-time';
      step2B.hidden = which !== 'current-past';
      btnBack.style.visibility = 'visible';
      progressLabel.textContent = 'Step 2 of 2';

      setPathHeader(which);

      if (which === 'first-time') {
        currentPastType.value = '';
        clearCurrentPast.hidden = true;
        hideAll(resultCurrentPast, '[data-cp]');
      }

      if (which === 'current-past') {
        firstTimeType.value = '';
        clearFirstTime.hidden = true;
        hideAll(resultFirstTime, '[data-ft]');
      }
    }

    function renderFirstTime(value) {
      clearFirstTime.hidden = !value;
      showOne(resultFirstTime, '[data-ft]', 'data-ft', value);
      if (value === 'freshman') initFreshmanMapOnce();
    }

    function renderCurrentPast(value) {
      clearCurrentPast.hidden = !value;
      showOne(resultCurrentPast, '[data-cp]', 'data-cp', value);
    }

    document.querySelectorAll('[data-step1]').forEach(btn => {
      btn.addEventListener('click', () => {
        const which = btn.getAttribute('data-step1');
        showStep2(which);
      });
    });

    btnBack.addEventListener('click', showStep1);
    btnRestart.addEventListener('click', showStep1);

    pathStartOver.addEventListener('click', (e) => {
      e.preventDefault();
      showStep1();
    });

    clearFirstTime.addEventListener('click', () => {
      firstTimeType.value = '';
      clearFirstTime.hidden = true;
      hideAll(resultFirstTime, '[data-ft]');
    });

    clearCurrentPast.addEventListener('click', () => {
      currentPastType.value = '';
      clearCurrentPast.hidden = true;
      hideAll(resultCurrentPast, '[data-cp]');
    });

    firstTimeType.addEventListener('change', (e) => renderFirstTime(e.target.value));
    currentPastType.addEventListener('change', (e) => renderCurrentPast(e.target.value));

    // Freshman map
    let freshmanMapInitialized = false;

    function initFreshmanMapOnce() {
      if (freshmanMapInitialized) return;

      const mapWrap = document.getElementById('map-wrap');
      const statusEl = document.getElementById('map-status');
      const resetBtn = document.getElementById('btn-reset');

      const freshmanMapView = document.getElementById('freshmanMapView');
      const freshmanResultView = document.getElementById('freshmanResultView');
      const backToMap = document.getElementById('backToMap');
      const resultHost = document.getElementById('freshmanResultHost');

      const indianaControls = document.getElementById('freshmanIndianaControls');
      const countySelect = document.getElementById('freshmanCountySelect');
      const hasCountyControls = Boolean(indianaControls && countySelect);

      if (!mapWrap || !statusEl || !resetBtn || !freshmanMapView || !freshmanResultView || !backToMap || !resultHost) return;

      freshmanMapInitialized = true;

      const SVG_URL = 'https://upload.wikimedia.org/wikipedia/commons/1/1a/Blank_US_Map_%28states_only%29.svg';

      const stateNameByAbbr = {
        AL:'Alabama', AK:'Alaska', AZ:'Arizona', AR:'Arkansas', CA:'California', CO:'Colorado', CT:'Connecticut',
        DE:'Delaware', FL:'Florida', GA:'Georgia', HI:'Hawaii', ID:'Idaho', IL:'Illinois', IN:'Indiana',
        IA:'Iowa', KS:'Kansas', KY:'Kentucky', LA:'Louisiana', ME:'Maine', MD:'Maryland', MA:'Massachusetts',
        MI:'Michigan', MN:'Minnesota', MS:'Mississippi', MO:'Missouri', MT:'Montana', NE:'Nebraska', NV:'Nevada',
        NH:'New Hampshire', NJ:'New Jersey', NM:'New Mexico', NY:'New York', NC:'North Carolina', ND:'North Dakota',
        OH:'Ohio', OK:'Oklahoma', OR:'Oregon', PA:'Pennsylvania', RI:'Rhode Island', SC:'South Carolina',
        SD:'South Dakota', TN:'Tennessee', TX:'Texas', UT:'Utah', VT:'Vermont', VA:'Virginia', WA:'Washington',
        WV:'West Virginia', WI:'Wisconsin', WY:'Wyoming'
      };

      // State counselor mapping keyed by abbreviation (more reliable than state name)
      const counselorIdByStateAbbr = {
        AL:'counselor5', AK:'counselor13', AZ:'counselor13', AR:'counselor13', CA:'counselor13',
        CO:'counselor13', CT:'counselor5', DE:'counselor5', FL:'counselor5', GA:'counselor5',
        HI:'counselor13', ID:'counselor13', IL:'counselor13', IN:'IN', IA:'counselor13', KS:'counselor13',
        KY:'counselor5', LA:'counselor13', ME:'counselor5', MD:'counselor5', MA:'counselor5',
        MI:'counselor4', MN:'counselor13', MS:'counselor5', MO:'counselor13', MT:'counselor13',
        NE:'counselor13', NV:'counselor13', NH:'counselor5', NJ:'counselor5', NM:'counselor13',
        NY:'counselor5', NC:'counselor5', ND:'counselor13', OH:'counselor1', OK:'counselor13',
        OR:'counselor13', PA:'counselor5', RI:'counselor5', SC:'counselor5', SD:'counselor13',
        TN:'counselor1', TX:'counselor13', UT:'counselor13', VT:'counselor5', VA:'counselor5', WA:'counselor13',
        WV:'counselor5', WI:'counselor13', WY:'counselor13'
      };

      const counselorIdByIndianaCounty = {
        'Adams County':'counselor9','Allen County':'counselor9','Bartholomew County':'counselor12','Benton County':'counselor11','Blackford County':'counselor7',
        'Boone County':'counselor11','Brown County':'counselor12','Carroll County':'counselor10','Cass County':'counselor10','Clark County':'counselor12',
        'Clay County':'counselor12','Clinton County':'counselor11','Crawford County':'counselor12','Daviess County':'counselor12','Dearborn County':'counselor12',
        'Decatur County':'counselor12','DeKalb County':'counselor9','Delaware County':'counselor11','Dubois County':'counselor12','Elkhart County':'counselor10',
        'Fayette County':'counselor11','Floyd County':'counselor12','Fountain County':'counselor11','Franklin County':'counselor11','Fulton County':'counselor10',
        'Gibson County':'counselor12','Grant County':'counselor7','Greene County':'counselor12','Hamilton County':'counselor8','Hancock County':'counselor8',
        'Harrison County':'counselor12','Hendricks County':'counselor8','Henry County':'counselor11','Howard County':'counselor7','Huntington County':'counselor9',
        'Jackson County':'counselor12','Jasper County':'counselor10','Jay County':'counselor9','Jefferson County':'counselor12','Jennings County':'counselor12',
        'Johnson County':'counselor8','Knox County':'counselor12','Kosciusko County':'counselor10','LaGrange County':'counselor9','Lake County':'counselor10',
        'LaPorte County':'counselor10','Lawrence County':'counselor12','Madison County':'counselor11','Marion County':'counselor8','Marshall County':'counselor10',
        'Martin County':'counselor12','Miami County':'counselor7','Monroe County':'counselor12','Montgomery County':'counselor11','Morgan County':'counselor11',
        'Newton County':'counselor10','Noble County':'counselor9','Ohio County':'counselor12','Orange County':'counselor12','Owen County':'counselor12',
        'Parke County':'counselor11','Perry County':'counselor12','Pike County':'counselor12','Porter County':'counselor10','Posey County':'counselor12',
        'Pulaski County':'counselor10','Putnam County':'counselor11','Randolph County':'counselor11','Ripley County':'counselor12','Rush County':'counselor11',
        'St. Joseph County':'counselor10','Scott County':'counselor12','Shelby County':'counselor8','Spencer County':'counselor12','Starke County':'counselor10',
        'Steuben County':'counselor9','Sullivan County':'counselor12','Switzerland County':'counselor12','Tippecanoe County':'counselor11','Tipton County':'counselor11',
        'Union County':'counselor11','Vanderburgh County':'counselor12','Vermillion County':'counselor11','Vigo County':'counselor12','Wabash County':'counselor7',
        'Warren County':'counselor11','Warrick County':'counselor12','Washington County':'counselor12','Wayne County':'counselor11','Wells County':'counselor9',
        'White County':'counselor10','Whitley County':'counselor9'
      };

      function setStatus(kind, text) {
        statusEl.className = 'alert py-2 small mb-3';
        statusEl.classList.add(kind === 'error' ? 'alert-danger' : kind === 'success' ? 'alert-success' : 'alert-info');
        statusEl.textContent = text;
      }

      function escapeHtml(str) {
        return String(str)
          .replaceAll('&', '&amp;')
          .replaceAll('<', '&lt;')
          .replaceAll('>', '&gt;')
          .replaceAll('"', '&quot;')
          .replaceAll("'", '&#039;');
      }

      function normalizeStateAbbr(abbr) {
        return String(abbr || '').trim().toUpperCase();
      }

      function normalizeCountyName(county) {
        const s = String(county || '').trim();
        if (!s) return '';
        return s.toLowerCase().endsWith(' county') ? s : (s + ' County');
      }

      function showMapOnly() {
        freshmanResultView.hidden = true;
        freshmanMapView.hidden = false;
        resultHost.innerHTML = '';
        if (hasCountyControls) {
          indianaControls.hidden = true;
          countySelect.value = '';
        }
      }

      function showResultOnly() {
        freshmanMapView.hidden = true;
        freshmanResultView.hidden = false;
      }

      function getPhoneLike(text) {
        const m = text.match(/[0-9]{3}-[0-9]{3}-[0-9]{4}/);
        return m ? m[0] : '';
      }

      function buildCard(sourceEl, headingText) {
        if (!sourceEl) {
          return '<div class="card border-0 bg-light" style="border-radius:1rem;">'
            + '<div class="card-body p-4">'
            + '<div class="h5">' + escapeHtml(headingText) + '</div>'
            + '<p class="text-muted mb-0">Counselor information is temporarily unavailable. Please contact <a href="mailto:admissions@indwes.edu">admissions@indwes.edu</a>.</p>'
            + '</div></div>';
        }

        if (sourceEl.id === 'counselor6') {
          return '<div class="card border-0 bg-light" style="border-radius:1rem;">'
            + '<div class="card-body p-4">'
            + '<div class="h5">' + escapeHtml(headingText) + '</div>'
            + '<p class="text-muted mb-0">Please email us to find your Admissions Counselor: <a href="mailto:admissions@indwes.edu">admissions@indwes.edu</a></p>'
            + '</div></div>';
        }

        const img = sourceEl.querySelector('img');
        const strong = sourceEl.querySelector('strong');
        const name = strong ? strong.textContent.replace(' is your Admissions Counselor!', '').trim() : 'Admissions Counselor';

        const mailtoEl = sourceEl.querySelector('a[href^="mailto:"]');
        const mailto = mailtoEl ? mailtoEl.getAttribute('href') : '';
        const emailText = mailto ? mailto.replace('mailto:', '') : '';

        const phoneText = getPhoneLike(sourceEl.textContent || '');

        const scheduleLinkEl = sourceEl.querySelector('a[href*="calendly"], a[href*="bookwithme"]');
        const scheduleLink = scheduleLinkEl ? scheduleLinkEl.getAttribute('href') : '';

        const getToKnowLinkEl = sourceEl.querySelector('a[href*="admissions-counselors"]');
        const getToKnowLink = getToKnowLinkEl ? getToKnowLinkEl.getAttribute('href') : '';

        const imgHtml = img ? '<img src="' + escapeHtml(img.getAttribute('src') || '') + '" alt="' + escapeHtml(img.getAttribute('alt') || name) + '" class="rounded-circle flex-shrink-0" style="width:72px;height:72px;object-fit:cover;" />' : '';

        const actions = [
          scheduleLink ? '<a class="btn btn-primary" href="' + escapeHtml(scheduleLink) + '" target="_blank" rel="noopener" role="button">Schedule a Chat</a>' : '',
          getToKnowLink ? '<a class="btn btn-outline-primary" href="' + escapeHtml(getToKnowLink) + '" role="button">Get to Know</a>' : ''
        ].filter(Boolean).join('');

        return (
          '<div class="card border-0 bg-light" style="border-radius:1rem;">'
          + '<div class="card-body p-4">'
          + '<div class="h5">' + escapeHtml(headingText) + '</div>'
          + '<div class="d-flex align-items-start gap-3 mt-3">'
          + imgHtml
          + '<div>'
          + '<div class="fw-semibold">' + escapeHtml(name) + '</div>'
          + (emailText ? '<div class="small">Email: <a href="' + escapeHtml(mailto) + '">' + escapeHtml(emailText) + '</a></div>' : '')
          + (phoneText ? '<div class="small">Phone: <a href="tel:+1' + escapeHtml(phoneText.replaceAll('-', '')) + '">' + escapeHtml(phoneText) + '</a></div>' : '')
          + '</div>'
          + '</div>'
          + (actions ? '<div class="d-flex flex-wrap gap-2 mt-3">' + actions + '</div>' : '')
          + '</div>'
          + '</div>'
        );
      }

      function buildCountyOptions() {
        if (!hasCountyControls) return;
        const counties = Object.keys(counselorIdByIndianaCounty).sort((a, b) => a.localeCompare(b));
        countySelect.innerHTML = ['<option value="" selected>Select a county…</option>']
          .concat(counties.map(c => '<option value="' + escapeHtml(c) + '">' + escapeHtml(c) + '</option>'))
          .join('');
      }

      function renderCounselorById(counselorId, headingText) {
        const source = document.getElementById(counselorId);
        resultHost.innerHTML = buildCard(source, headingText);
        showResultOnly();
      }

      function showForStateAbbr(abbrRaw) {
        const abbr = normalizeStateAbbr(abbrRaw);
        const stateName = stateNameByAbbr[abbr];
        if (!stateName) return;

        if (abbr === 'IN') {
          if (hasCountyControls) {
            indianaControls.hidden = false;
            buildCountyOptions();
            resultHost.innerHTML = '';
            showResultOnly();
          } else {
            renderCounselorById('counselor6', 'Admissions Counselor for Indiana');
          }
          return;
        }

        if (hasCountyControls) indianaControls.hidden = true;

        const counselorId = counselorIdByStateAbbr[abbr];
        if (!counselorId) {
          console.warn('No counselor mapping found for state:', abbr, stateName);
          renderCounselorById('counselor6', 'Admissions Counselor for ' + stateName);
          return;
        }

        renderCounselorById(counselorId, 'Admissions Counselor for ' + stateName);
      }

      if (hasCountyControls) {
        countySelect.addEventListener('change', () => {
          const raw = countySelect.value;
          if (!raw) return;

          const key = normalizeCountyName(raw);
          const counselorId = counselorIdByIndianaCounty[key] || counselorIdByIndianaCounty[raw] || 'counselor6';

          if (!counselorId || counselorId === 'counselor6') {
            console.warn('No counselor mapping found for county:', raw, 'normalized:', key);
          }

          renderCounselorById(counselorId, 'Admissions Counselor for ' + key);
        });
      }

      backToMap.addEventListener('click', (e) => {
        e.preventDefault();
        showMapOnly();
      });

      resetBtn.addEventListener('click', () => {
        showMapOnly();
        setStatus('info', 'Click a state to see its Admissions Counselor');
      });

      async function loadSvg() {
        setStatus('info', 'Loading map…');
        try {
          const res = await fetch(SVG_URL, { mode: 'cors' });
          if (!res.ok) throw new Error('HTTP ' + res.status);
          const svgText = await res.text();
          mapWrap.innerHTML = svgText;
          const svg = mapWrap.querySelector('svg');
          if (!svg) throw new Error('SVG did not load correctly');

          const widthAttr = svg.getAttribute('width');
          const heightAttr = svg.getAttribute('height');

          if (!svg.getAttribute('viewBox')) {
            if (widthAttr && heightAttr) {
              svg.setAttribute('viewBox', '0 0 ' + parseFloat(widthAttr) + ' ' + parseFloat(heightAttr));
            }
          }

          svg.removeAttribute('width');
          svg.removeAttribute('height');

          svg.style.width = '100%';
          svg.style.height = '100%';
          svg.style.display = 'block';
          svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');

          const abbrSet = new Set(Object.keys(stateNameByAbbr));

          function resolveAbbrFromId(rawId) {
            if (!rawId) return null;
            const upper = rawId.trim().toUpperCase();
            if (abbrSet.has(upper)) return upper;
            if (upper.startsWith('US-') && abbrSet.has(upper.slice(3))) return upper.slice(3);
            if (upper.startsWith('US_') && abbrSet.has(upper.slice(3))) return upper.slice(3);
            const last2 = upper.slice(-2);
            if (abbrSet.has(last2)) return last2;
            return null;
          }

          function resolveAbbrFromTitle(el) {
            const titleEl = el && el.querySelector ? el.querySelector('title') : null;
            if (!titleEl) return null;
            const name = titleEl.textContent.trim();
            for (const key in stateNameByAbbr) {
              if (stateNameByAbbr[key] === name) return key;
            }
            return null;
          }

          svg.addEventListener('click', (e) => {
            // The Wikimedia SVG uses nested shapes. Walk up until we find an element
            // with an id or a title that resolves to a state.
            let node = e.target;
            let abbr = null;

            while (node && node !== svg && !abbr) {
              if (node.getAttribute) {
                abbr = resolveAbbrFromId(node.getAttribute('id')) || resolveAbbrFromTitle(node);
              }
              node = node.parentElement;
            }

            if (!abbr) return;

            setStatus('info', 'Selected: ' + stateNameByAbbr[abbr]);
            showForStateAbbr(abbr);
          });

          let detected = 0;
          svg.querySelectorAll('path, polygon, g').forEach(el => {
            let abbr = resolveAbbrFromId(el.getAttribute('id'));
            if (!abbr) abbr = resolveAbbrFromTitle(el);
            if (!abbr) return;
            detected += 1;
            el.classList.add('state-shape');
            el.setAttribute('tabindex', '0');
            el.setAttribute('role', 'button');
            el.setAttribute('aria-label', 'State: ' + stateNameByAbbr[abbr]);
            el.addEventListener('keydown', (evt) => {
              if (evt.key === 'Enter' || evt.key === ' ') {
                evt.preventDefault();
                el.dispatchEvent(new MouseEvent('click', { bubbles: true }));
              }
            });
          });

          setStatus('success', 'Map loaded. ' + detected + ' clickable state elements detected. Click a state.');
          showMapOnly();
        } catch (err) {
          setStatus('error', 'Could not load the SVG. Download and host it locally, then update SVG_URL.');
          mapWrap.innerHTML = '';
          console.error(err);
        }
      }

      loadSvg();
    }

    showStep1();
  })();
  </script>
</body>
</html>
